<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåô Tournoi Ramadan 2026 ‚Äî Inscription</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Outfit:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold:#D4A745;--gold-bright:#F2CC6B;--gold-dim:#8B6F2E;
            --bg-deep:#0A0E1A;--bg-card:#0F1525;--bg-card-hover:#151D33;
            --surface:#1A2238;--border:rgba(212,167,69,0.15);--border-active:rgba(212,167,69,0.4);
            --text:#E8E6E1;--text-dim:#8A8B94;
            --green:#34D399;--red:#F87171;--blue:#60A5FA;--purple:#A78BFA;
            --teal:#2DD4BF;--orange:#FB923C;
            --radius:16px;--radius-sm:10px;
        }
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Outfit',sans-serif;background:var(--bg-deep);color:var(--text);min-height:100vh;overflow-x:hidden}
        .bg-pattern{position:fixed;inset:0;z-index:0;opacity:0.03;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Cpath d='M40 0L80 40L40 80L0 40Z' fill='none' stroke='%23D4A745' stroke-width='0.5'/%3E%3Cpath d='M40 10L70 40L40 70L10 40Z' fill='none' stroke='%23D4A745' stroke-width='0.3'/%3E%3Ccircle cx='40' cy='40' r='15' fill='none' stroke='%23D4A745' stroke-width='0.3'/%3E%3C/svg%3E");background-size:80px 80px}
        .bg-glow{position:fixed;width:600px;height:600px;border-radius:50%;filter:blur(150px);opacity:0.07;z-index:0;pointer-events:none}
        .bg-glow-1{background:var(--gold);top:-200px;right:-100px}
        .bg-glow-2{background:#6366F1;bottom:-200px;left:-100px}
        .container{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:0 24px}

        /* Header */
        header{padding:32px 0;text-align:center}
        .moon-icon{font-size:56px;display:block;margin-bottom:12px;animation:float 4s ease-in-out infinite}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        header h1{font-family:'Amiri',serif;font-size:clamp(2.2rem,5vw,3.5rem);font-weight:700;background:linear-gradient(135deg,var(--gold-bright),var(--gold),var(--gold-dim));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:-0.5px}
        header p{color:var(--text-dim);font-size:1.05rem;margin-top:8px;font-weight:300}
        .admin-link{position:absolute;top:24px;right:24px;color:var(--text-dim);text-decoration:none;font-size:0.82rem;padding:8px 16px;border:1px solid var(--border);border-radius:999px;transition:all 0.3s}
        .admin-link:hover{border-color:var(--gold);color:var(--gold)}

        /* Countdown */
        .countdown-bar{display:flex;justify-content:center;gap:20px;margin:24px 0 40px;flex-wrap:wrap}
        .countdown-item{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-sm);padding:14px 22px;text-align:center;min-width:80px}
        .countdown-item .num{font-family:'JetBrains Mono',monospace;font-size:1.8rem;font-weight:500;color:var(--gold-bright)}
        .countdown-item .label{font-size:0.72rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1.5px;margin-top:4px}

        /* Tabs */
        .tabs{display:flex;justify-content:center;gap:8px;margin-bottom:40px;flex-wrap:wrap}
        .tab-btn{background:var(--bg-card);border:1px solid var(--border);border-radius:999px;padding:10px 28px;color:var(--text-dim);font-family:'Outfit',sans-serif;font-size:0.92rem;font-weight:500;cursor:pointer;transition:all 0.3s}
        .tab-btn:hover{border-color:var(--border-active);color:var(--text)}
        .tab-btn.active{background:linear-gradient(135deg,var(--gold-dim),var(--gold));color:var(--bg-deep);border-color:var(--gold);font-weight:600}
        .tab-content{display:none;animation:fadeUp 0.4s ease}
        .tab-content.active{display:block}
        @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

        /* Form */
        .form-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:40px;max-width:560px;margin:0 auto;position:relative;overflow:hidden}
        .form-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,transparent,var(--gold),transparent)}
        .form-card h2{font-family:'Amiri',serif;font-size:1.6rem;color:var(--gold-bright);margin-bottom:28px;text-align:center}
        .form-group{margin-bottom:22px}
        .form-group label{display:block;font-size:0.85rem;font-weight:500;color:var(--text-dim);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.8px}
        .form-group input,.form-group select{width:100%;padding:14px 18px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-family:'Outfit',sans-serif;font-size:1rem;transition:all 0.3s;outline:none}
        .form-group input:focus,.form-group select:focus{border-color:var(--gold);box-shadow:0 0 0 3px rgba(212,167,69,0.1)}
        .form-group input::placeholder{color:#4A4D5A}
        .form-group select option{background:var(--bg-card);color:var(--text)}
        .custom-game-wrapper{display:none;margin-top:10px}
        .custom-game-wrapper.show{display:block}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
        .submit-btn{width:100%;padding:16px;background:linear-gradient(135deg,var(--gold-dim),var(--gold),var(--gold-bright));border:none;border-radius:var(--radius-sm);color:var(--bg-deep);font-family:'Outfit',sans-serif;font-size:1.05rem;font-weight:700;cursor:pointer;transition:all 0.3s;text-transform:uppercase;letter-spacing:1px;margin-top:8px}
        .submit-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(212,167,69,0.3)}
        .submit-btn:active{transform:translateY(0)}
        .submit-btn.loading{pointer-events:none;opacity:0.7}

        /* Toast */
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);padding:16px 32px;border-radius:var(--radius-sm);font-weight:500;z-index:999;transition:transform 0.4s cubic-bezier(0.22,1,0.36,1);box-shadow:0 12px 40px rgba(0,0,0,0.4)}
        .toast.show{transform:translateX(-50%) translateY(0)}
        .toast.success{background:var(--green);color:#042F20}
        .toast.error{background:var(--red);color:#2A0A0A}

        /* Stats */
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:16px;margin-bottom:40px}
        .stat-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-sm);padding:24px 16px;text-align:center;transition:all 0.3s}
        .stat-card:hover{border-color:var(--border-active);transform:translateY(-3px)}
        .stat-card .stat-num{font-family:'JetBrains Mono',monospace;font-size:2rem;font-weight:700;color:var(--gold-bright)}
        .stat-card .stat-label{font-size:0.78rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-top:6px}

        /* Rankings */
        .rankings-section{max-width:700px;margin:0 auto}
        .rankings-section h2,.participants-section h2{font-family:'Amiri',serif;font-size:1.6rem;color:var(--gold-bright);text-align:center;margin-bottom:28px}
        .game-bar-item{display:flex;align-items:center;gap:16px;margin-bottom:18px;animation:fadeUp 0.5s ease backwards}
        .game-rank{font-family:'JetBrains Mono',monospace;font-size:0.85rem;color:var(--text-dim);min-width:28px;text-align:center}
        .game-rank.gold{color:var(--gold-bright);font-weight:700;font-size:1.1rem}
        .game-rank.silver{color:#C0C0C0;font-weight:600}
        .game-rank.bronze{color:#CD7F32;font-weight:600}
        .game-icon{font-size:1.6rem;width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:var(--surface);border-radius:10px;border:1px solid var(--border)}
        .game-info{flex:1}
        .game-name{font-weight:600;font-size:1rem;margin-bottom:6px}
        .game-bar-bg{width:100%;height:10px;background:var(--surface);border-radius:99px;overflow:hidden}
        .game-bar-fill{height:100%;border-radius:99px;transition:width 1.2s cubic-bezier(0.22,1,0.36,1);width:0}
        .bar-color-1{background:linear-gradient(90deg,var(--gold-dim),var(--gold-bright))}
        .bar-color-2{background:linear-gradient(90deg,#6366F1,#818CF8)}
        .bar-color-3{background:linear-gradient(90deg,#059669,var(--green))}
        .bar-color-4{background:linear-gradient(90deg,#DC2626,var(--red))}
        .bar-color-5{background:linear-gradient(90deg,#7C3AED,var(--purple))}
        .bar-color-6{background:linear-gradient(90deg,#0D9488,var(--teal))}
        .bar-color-7{background:linear-gradient(90deg,#C2410C,var(--orange))}
        .bar-color-8{background:linear-gradient(90deg,var(--blue),#93C5FD)}
        .game-count{font-family:'JetBrains Mono',monospace;font-size:0.92rem;font-weight:500;color:var(--gold);min-width:60px;text-align:right}

        /* Participants */
        .participants-section{max-width:800px;margin:0 auto}
        .participants-table{width:100%;border-collapse:separate;border-spacing:0 6px}
        .participants-table thead th{font-size:0.75rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-dim);padding:10px 16px;text-align:left;font-weight:500}
        .participants-table tbody tr{background:var(--bg-card);transition:all 0.2s;animation:fadeUp 0.4s ease backwards}
        .participants-table tbody tr:hover{background:var(--bg-card-hover)}
        .participants-table td{padding:14px 16px;font-size:0.95rem}
        .participants-table td:first-child{border-radius:var(--radius-sm) 0 0 var(--radius-sm)}
        .participants-table td:last-child{border-radius:0 var(--radius-sm) var(--radius-sm) 0}
        .game-badge{display:inline-block;padding:4px 14px;border-radius:999px;font-size:0.8rem;font-weight:600;background:rgba(212,167,69,0.12);color:var(--gold-bright);border:1px solid rgba(212,167,69,0.2)}
        .participant-num{font-family:'JetBrains Mono',monospace;color:var(--text-dim);font-size:0.85rem}
        .participant-date{color:var(--text-dim);font-size:0.82rem}
        .empty-state{text-align:center;padding:60px 20px;color:var(--text-dim)}
        .empty-state .empty-icon{font-size:3rem;margin-bottom:16px;opacity:0.4}

        footer{text-align:center;padding:48px 0 32px;color:var(--text-dim);font-size:0.85rem;border-top:1px solid var(--border);margin-top:60px}
        footer span{color:var(--gold)}

        @media(max-width:600px){
            .form-card{padding:28px 20px}
            .form-row{grid-template-columns:1fr}
            .countdown-bar{gap:10px}
            .countdown-item{min-width:65px;padding:10px 14px}
            .countdown-item .num{font-size:1.4rem}
            .stats-grid{grid-template-columns:repeat(2,1fr)}
            .game-bar-item{gap:10px}
            .game-icon{width:36px;height:36px;font-size:1.2rem}
        }
        ::-webkit-scrollbar{width:8px}
        ::-webkit-scrollbar-track{background:var(--bg-deep)}
        ::-webkit-scrollbar-thumb{background:var(--gold-dim);border-radius:99px}
    </style>
</head>
<body>

<div class="bg-pattern"></div>
<div class="bg-glow bg-glow-1"></div>
<div class="bg-glow bg-glow-2"></div>

<a href="/admin" class="admin-link">üîê Admin</a>

<div class="container">
    <header>
        <span class="moon-icon">üåô</span>
        <h1>Tournoi Ramadan 2026</h1>
        <p>Inscris-toi et affronte les meilleurs joueurs pendant le mois sacr√©</p>
        <div class="countdown-bar" id="countdown">
            <div class="countdown-item"><div class="num" id="cd-days">--</div><div class="label">Jours</div></div>
            <div class="countdown-item"><div class="num" id="cd-hours">--</div><div class="label">Heures</div></div>
            <div class="countdown-item"><div class="num" id="cd-mins">--</div><div class="label">Minutes</div></div>
            <div class="countdown-item"><div class="num" id="cd-secs">--</div><div class="label">Secondes</div></div>
        </div>
    </header>

    <div class="tabs">
        <button class="tab-btn active" data-tab="register">üìù Inscription</button>
        <button class="tab-btn" data-tab="stats">üìä Statistiques</button>
        <button class="tab-btn" data-tab="participants">üë• Participants</button>
    </div>

    <!-- INSCRIPTION -->
    <div class="tab-content active" id="tab-register">
        <div class="form-card">
            <h2>‚ú¶ Formulaire d'Inscription ‚ú¶</h2>
            <form id="registerForm" autocomplete="off">
                <div class="form-group">
                    <label>Nom du joueur *</label>
                    <input type="text" id="playerName" placeholder="Entre ton nom ou pseudo..." required maxlength="40">
                </div>
                <div class="form-group">
                    <label>Jeu du tournoi *</label>
                    <select id="gameSelect" required>
                        <option value="" disabled selected>Choisis ton jeu...</option>
                        <option value="eFootball">‚öΩ eFootball (PES)</option>
                        <option value="FC 25">‚öΩ EA FC 25 (FIFA)</option>
                        <option value="Free Fire">üî´ Free Fire</option>
                        <option value="PUBG Mobile">üî´ PUBG Mobile</option>
                        <option value="Call of Duty Mobile">üéØ Call of Duty Mobile</option>
                        <option value="Fortnite">üèóÔ∏è Fortnite</option>
                        <option value="Valorant">üéÆ Valorant</option>
                        <option value="League of Legends">‚öîÔ∏è League of Legends</option>
                        <option value="Rocket League">üöó Rocket League</option>
                        <option value="Brawl Stars">‚≠ê Brawl Stars</option>
                        <option value="Clash Royale">üëë Clash Royale</option>
                        <option value="Tekken 8">ü•ä Tekken 8</option>
                        <option value="Street Fighter 6">ü•ã Street Fighter 6</option>
                        <option value="Autre">‚ûï Autre (pr√©ciser)</option>
                    </select>
                </div>
                <div class="form-group custom-game-wrapper" id="customGameWrapper">
                    <label>Nom du jeu</label>
                    <input type="text" id="customGame" placeholder="Pr√©cise le nom du jeu..." maxlength="40">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Email (optionnel)</label>
                        <input type="email" id="playerEmail" placeholder="ton@email.com">
                    </div>
                    <div class="form-group">
                        <label>T√©l√©phone (optionnel)</label>
                        <input type="tel" id="playerPhone" placeholder="+216 XX XXX XXX">
                    </div>
                </div>
                <button type="submit" class="submit-btn" id="submitBtn">üåô S'inscrire au Tournoi</button>
            </form>
        </div>
    </div>

    <!-- STATS -->
    <div class="tab-content" id="tab-stats">
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card"><div class="stat-num" id="totalPlayers">0</div><div class="stat-label">Joueurs</div></div>
            <div class="stat-card"><div class="stat-num" id="totalGames">0</div><div class="stat-label">Jeux</div></div>
            <div class="stat-card"><div class="stat-num" id="topGame">‚Äî</div><div class="stat-label">Jeu #1</div></div>
            <div class="stat-card"><div class="stat-num" id="todayCount">0</div><div class="stat-label">Aujourd'hui</div></div>
        </div>
        <div class="rankings-section">
            <h2>üèÜ Classement des Jeux les Plus Demand√©s</h2>
            <div id="gameRankings"></div>
        </div>
    </div>

    <!-- PARTICIPANTS -->
    <div class="tab-content" id="tab-participants">
        <div class="participants-section">
            <h2>üë• Liste des Inscrits</h2>
            <table class="participants-table">
                <thead><tr><th>#</th><th>Joueur</th><th>Jeu</th><th>Date</th></tr></thead>
                <tbody id="participantsList"></tbody>
            </table>
            <div class="empty-state" id="emptyState"><div class="empty-icon">üéÆ</div><p>Aucun inscrit pour le moment ‚Äî sois le premier !</p></div>
        </div>
    </div>

    <footer><p>üåô Tournoi Ramadan 2026 ‚Äî Que le meilleur gagne ! <span>‚ú¶</span></p></footer>
</div>

<div class="toast" id="toast"></div>

<script>
const API = '';
const gameIcons = {'eFootball':'‚öΩ','FC 25':'‚öΩ','Free Fire':'üî´','PUBG Mobile':'üî´','Call of Duty Mobile':'üéØ','Fortnite':'üèóÔ∏è','Valorant':'üéÆ','League of Legends':'‚öîÔ∏è','Rocket League':'üöó','Brawl Stars':'‚≠ê','Clash Royale':'üëë','Tekken 8':'ü•ä','Street Fighter 6':'ü•ã'};
const barColors = ['bar-color-1','bar-color-2','bar-color-3','bar-color-4','bar-color-5','bar-color-6','bar-color-7','bar-color-8'];

// Tabs
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
        if (btn.dataset.tab === 'stats') loadStats();
        if (btn.dataset.tab === 'participants') loadParticipants();
    });
});

// Custom game
document.getElementById('gameSelect').addEventListener('change', function() {
    const w = document.getElementById('customGameWrapper');
    this.value === 'Autre' ? w.classList.add('show') : w.classList.remove('show');
});

// Form submit
document.getElementById('registerForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    const name = document.getElementById('playerName').value.trim();
    let game = document.getElementById('gameSelect').value;
    const email = document.getElementById('playerEmail').value.trim();
    const phone = document.getElementById('playerPhone').value.trim();

    if (game === 'Autre') {
        const c = document.getElementById('customGame').value.trim();
        if (!c) { showToast('Pr√©cise le nom du jeu !', 'error'); return; }
        game = c;
    }
    if (!name || !game) { showToast('Remplis les champs obligatoires !', 'error'); return; }

    btn.classList.add('loading');
    btn.textContent = '‚è≥ Inscription en cours...';

    try {
        const res = await fetch(API + '/api/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, game, email, phone })
        });
        const data = await res.json();
        if (res.ok) {
            showToast(`‚úÖ ${name} inscrit √† ${game} ‚Äî Bonne chance !`, 'success');
            this.reset();
            document.getElementById('customGameWrapper').classList.remove('show');
        } else {
            showToast(data.error || 'Erreur d\'inscription', 'error');
        }
    } catch (err) {
        showToast('Erreur de connexion au serveur', 'error');
    }

    btn.classList.remove('loading');
    btn.textContent = 'üåô S\'inscrire au Tournoi';
});

// Load Stats
async function loadStats() {
    try {
        const res = await fetch(API + '/api/stats');
        const data = await res.json();
        document.getElementById('totalPlayers').textContent = data.totalPlayers;
        document.getElementById('totalGames').textContent = data.totalGames;
        document.getElementById('topGame').textContent = data.topGame;
        document.getElementById('todayCount').textContent = data.todayCount;

        const container = document.getElementById('gameRankings');
        if (!data.gameRankings.length) {
            container.innerHTML = '<div class="empty-state"><div class="empty-icon">üìä</div><p>Pas encore de donn√©es</p></div>';
            return;
        }
        const max = data.gameRankings[0].count;
        container.innerHTML = data.gameRankings.map((g, i) => {
            const pct = (g.count / max) * 100;
            const icon = gameIcons[g.game] || 'üéÆ';
            const rc = i===0?'gold':i===1?'silver':i===2?'bronze':'';
            return `<div class="game-bar-item" style="animation-delay:${i*0.05}s">
                <div class="game-rank ${rc}">#${i+1}</div>
                <div class="game-icon">${icon}</div>
                <div class="game-info"><div class="game-name">${g.game}</div>
                    <div class="game-bar-bg"><div class="game-bar-fill ${barColors[i%8]}" data-width="${pct}"></div></div>
                </div>
                <div class="game-count">${g.count} joueur${g.count>1?'s':''}</div>
            </div>`;
        }).join('');
        requestAnimationFrame(() => setTimeout(() => {
            container.querySelectorAll('.game-bar-fill').forEach(b => b.style.width = b.dataset.width + '%');
        }, 50));
    } catch (e) { console.error(e); }
}

// Load Participants
async function loadParticipants() {
    try {
        const res = await fetch(API + '/api/participants');
        const data = await res.json();
        const tbody = document.getElementById('participantsList');
        const empty = document.getElementById('emptyState');
        if (!data.length) { tbody.innerHTML = ''; empty.style.display = 'block'; return; }
        empty.style.display = 'none';
        tbody.innerHTML = data.map((r, i) => {
            const d = new Date(r.created_at);
            const ds = d.toLocaleDateString('fr-FR',{day:'numeric',month:'short',year:'numeric'});
            const ts = d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'});
            return `<tr style="animation-delay:${i*0.04}s">
                <td class="participant-num">${data.length - i}</td>
                <td><strong>${r.name}</strong></td>
                <td><span class="game-badge">${gameIcons[r.game]||'üéÆ'} ${r.game}</span></td>
                <td class="participant-date">${ds} ${ts}</td>
            </tr>`;
        }).join('');
    } catch (e) { console.error(e); }
}

// Countdown
function updateCountdown() {
    const target = new Date('2026-02-17T00:00:00');
    const diff = target - new Date();
    if (diff <= 0) { document.getElementById('cd-days').textContent='üåô'; return; }
    document.getElementById('cd-days').textContent = String(Math.floor(diff/86400000)).padStart(2,'0');
    document.getElementById('cd-hours').textContent = String(Math.floor((diff%86400000)/3600000)).padStart(2,'0');
    document.getElementById('cd-mins').textContent = String(Math.floor((diff%3600000)/60000)).padStart(2,'0');
    document.getElementById('cd-secs').textContent = String(Math.floor((diff%60000)/1000)).padStart(2,'0');
}
setInterval(updateCountdown, 1000);
updateCountdown();

function showToast(msg, type) {
    const t = document.getElementById('toast');
    t.textContent = msg; t.className = 'toast ' + type;
    setTimeout(() => t.classList.add('show'), 10);
    setTimeout(() => t.classList.remove('show'), 3500);
}

loadStats(); loadParticipants();
</script>
</body>
</html>
